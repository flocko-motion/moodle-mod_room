{"version":3,"sources":["../src/slot_display_filters.js"],"names":["define","str","init","filterlist","filters","split","filter","f","length","filterContainer","document","createElement","id","roomPlanContainer","getElementById","insertAdjacentElement","title","appendChild","get_string","then","titleString","createTextNode","filterButtons","filterSlots","slots","children","forEach","slot","classList","remove","dataset","eventTitle","toLowerCase","includes","add","selectFilter","event","target","contains","filterButton","textContent","filterName","innerHTML","push","addEventListener"],"mappings":"w9BAyBAA,OAAM,iCAAC,CAAC,UAAD,CAAD,CAAe,SAASC,CAAT,CAAc,CAC/B,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAqB,CACvB,GAAMC,CAAAA,CAAO,CAAGD,CAAU,CAACE,KAAX,CAAiB,GAAjB,EAAsBC,MAAtB,CAA6B,SAAAC,CAAC,QAAIA,CAAAA,CAAJ,CAA9B,CAAhB,CAGA,GAAqB,CAAjB,CAAAH,CAAO,CAACI,MAAZ,CAAwB,CACpB,MACH,CAGD,GAAMC,CAAAA,CAAe,CAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAxB,CACAF,CAAe,CAACG,EAAhB,CAAqB,uBAArB,CAEA,GAAMC,CAAAA,CAAiB,CAAGH,QAAQ,CAACI,cAAT,CAAwB,oBAAxB,CAA1B,CACAD,CAAiB,CAACE,qBAAlB,CAAwC,aAAxC,CAAuDN,CAAvD,EAEA,GAAMO,CAAAA,CAAK,CAAGN,QAAQ,CAACC,aAAT,CAAuB,IAAvB,CAAd,CACAF,CAAe,CAACQ,WAAhB,CAA4BD,CAA5B,EACAf,CAAG,CAACiB,UAAJ,CAAe,aAAf,CAA8B,UAA9B,EACKC,IADL,CACU,SAAAC,CAAW,CAAI,CACjBJ,CAAK,CAACC,WAAN,CAAkBP,QAAQ,CAACW,cAAT,CAAwBD,CAAxB,CAAlB,CACH,CAHL,EAjBuB,GAsBnBE,CAAAA,CAAa,CAAG,EAtBG,CAwBjBC,CAAW,CAAG,SAASjB,CAAT,CAAiB,CACjC,GAAIkB,CAAAA,CAAK,oBAAOd,QAAQ,CAACI,cAAT,CAAwB,mBAAxB,EAA6CW,QAApD,CAAT,CACAD,CAAK,CAACE,OAAN,CAAc,SAAAC,CAAI,CAAI,CAClBA,CAAI,CAACC,SAAL,CAAeC,MAAf,CAAsB,QAAtB,EACA,GACIvB,CAAM,EACN,CAACqB,CAAI,CAACG,OAAL,CAAaC,UAAb,CAAwBC,WAAxB,GAAsCC,QAAtC,CAA+C3B,CAAM,CAAC0B,WAAP,EAA/C,CAFL,CAGE,CACEL,CAAI,CAACC,SAAL,CAAeM,GAAf,CAAmB,QAAnB,CACH,CACJ,CARD,CASH,CAnCsB,CAqCjBC,CAAY,CAAG,SAASC,CAAT,CAAgB,CAEjC,GAAIA,CAAK,CAACC,MAAN,CAAaT,SAAb,CAAuBU,QAAvB,CAAgC,UAAhC,CAAJ,CAAiD,CAC7CF,CAAK,CAACC,MAAN,CAAaT,SAAb,CAAuBC,MAAvB,CAA8B,UAA9B,EAEAN,CAAW,EACd,CAJD,IAIO,CAEHD,CAAa,CAACI,OAAd,CAAsB,SAACa,CAAD,CAAkB,CACpCA,CAAY,CAACX,SAAb,CAAuBC,MAAvB,CAA8B,UAA9B,CACH,CAFD,EAGAO,CAAK,CAACC,MAAN,CAAaT,SAAb,CAAuBM,GAAvB,CAA2B,UAA3B,EAEAX,CAAW,CAACa,CAAK,CAACC,MAAN,CAAaG,WAAd,CACd,CACJ,CApDsB,CAuDvBpC,CAAO,CAACsB,OAAR,CAAgB,SAAAe,CAAU,CAAI,CAC1B,GAAIF,CAAAA,CAAY,CAAG7B,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAnB,CACA4B,CAAY,CAACG,SAAb,CAAyBD,CAAzB,CACAhC,CAAe,CAACQ,WAAhB,CAA4BsB,CAA5B,EAEAjB,CAAa,CAACqB,IAAd,CAAmBJ,CAAnB,EAEAA,CAAY,CAACK,gBAAb,CAA8B,OAA9B,CAAuCT,CAAvC,CACH,CARD,CASH,CAjEE,CAmEV,CApEK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Setup slot display filters.\n *\n * @package    mod_room\n * @copyright  2020 Leo Auri <code@leoauri.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/*eslint no-unused-vars: \"warn\"*/\n\ndefine(['core/str'], function(str) {\n    return {\n        init: function(filterlist) {\n            const filters = filterlist.split(\",\").filter(f => f);\n\n            // Leave if no filters are specified\n            if (filters.length < 1) {\n                return;\n            }\n\n            // Create and insert container for filter controls\n            const filterContainer = document.createElement(\"div\");\n            filterContainer.id = 'mod-room-slot-filters';\n\n            const roomPlanContainer = document.getElementById('mod-room-room-plan');\n            roomPlanContainer.insertAdjacentElement('beforebegin', filterContainer);\n\n            const title = document.createElement('h4');\n            filterContainer.appendChild(title);\n            str.get_string('filterslots', 'mod_room')\n                .then(titleString => {\n                    title.appendChild(document.createTextNode(titleString));\n                });\n\n            let filterButtons = [];\n\n            const filterSlots = function(filter) {\n                let slots = [...document.getElementById('mod-room-roomplan').children];\n                slots.forEach(slot => {\n                    slot.classList.remove('hidden');\n                    if (\n                        filter &&\n                        !slot.dataset.eventTitle.toLowerCase().includes(filter.toLowerCase())\n                    ) {\n                        slot.classList.add('hidden');\n                    }\n                });\n            };\n\n            const selectFilter = function(event) {\n                // If filter was already selected, deselect\n                if (event.target.classList.contains('selected')) {\n                    event.target.classList.remove('selected');\n\n                    filterSlots();\n                } else {\n                    // otherwise select it exclusively\n                    filterButtons.forEach((filterButton) => {\n                        filterButton.classList.remove('selected');\n                    });\n                    event.target.classList.add('selected');\n\n                    filterSlots(event.target.textContent);\n                }\n            };\n\n            // Add filter buttons\n            filters.forEach(filterName => {\n                let filterButton = document.createElement('span');\n                filterButton.innerHTML = filterName;\n                filterContainer.appendChild(filterButton);\n\n                filterButtons.push(filterButton);\n\n                filterButton.addEventListener('click', selectFilter);\n            });\n        }\n    };\n});"],"file":"slot_display_filters.min.js"}